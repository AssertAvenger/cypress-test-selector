# Project Structure

## Monorepo Layout

```
cypress-test-selector/
├── packages/
│   ├── core/                    # Core diff parsing & mapping logic
│   │   ├── src/
│   │   │   ├── diff/            # Git diff parsing
│   │   │   ├── mapper/          # Test mapping heuristics
│   │   │   ├── safety/          # Safety level logic
│   │   │   └── utils/           # Utility functions
│   │   ├── tests/               # Unit tests
│   │   ├── package.json
│   │   └── tsconfig.json
│   │
│   └── cli/                     # Command-line interface
│       ├── src/
│       │   ├── commands/        # CLI commands
│       │   ├── config/          # Configuration loading
│       │   └── output/          # Output generation
│       ├── tests/
│       ├── package.json
│       └── tsconfig.json
│
├── examples/
│   └── demo-app/                # Demo React + Cypress app
│       ├── src/                 # React source
│       ├── cypress/
│       │   ├── e2e/             # Demo test files
│       │   └── support/
│       ├── package.json
│       └── tsconfig.json
│
├── package.json                 # Root workspace config
├── tsconfig.base.json           # Shared TypeScript config
├── .gitignore
├── LICENSE
├── README.md
├── ARCHITECTURE.md              # Detailed architecture plan
└── STRUCTURE.md                 # This file
```

## Package Responsibilities

### `packages/core`
- **Purpose**: Core business logic, framework-agnostic
- **Exports**: Diff parsing, test mapping, safety validation
- **Dependencies**: Minimal (no Cypress dependency)

### `packages/cli`
- **Purpose**: User-facing CLI tool
- **Exports**: CLI executable (`cypress-test-selector`)
- **Dependencies**: `@cypress-test-selector/core`

### `examples/demo-app`
- **Purpose**: Demonstration and integration testing
- **Dependencies**: React, Cypress, `cypress-test-selector` (workspace)

## File Organization Plan

### Core Package Files (to be created)

```
packages/core/src/
├── index.ts                      # Main exports
├── diff/
│   ├── parser.ts                 # Parse git diff output
│   └── types.ts                  # ChangedFile, DiffResult types
├── mapper/
│   ├── index.ts                  # Mapping orchestrator
│   ├── directory-heuristic.ts   # Directory-based matching
│   ├── similarity-heuristic.ts  # Filename similarity
│   ├── import-graph.ts          # Import analysis
│   └── conservative.ts          # Conservative fallback
├── safety/
│   ├── levels.ts                # Safety level enum & config
│   └── validator.ts             # High-safety validation
└── utils/
    ├── file-utils.ts            # Path utilities
    └── test-discovery.ts        # Find Cypress test files
```

### CLI Package Files (to be created)

```
packages/cli/src/
├── cli.ts                        # CLI entry point
├── commands/
│   └── run.ts                    # Main run command
├── config/
│   └── loader.ts                 # Config file loading
└── output/
    └── writer.ts                 # JSON output writer
```

## Next Implementation Steps

1. **Core: Diff Parser** - Parse git diff into structured data
2. **Core: Test Discovery** - Find all Cypress test files
3. **Core: Directory Heuristic** - Basic directory-based mapping
4. **Core: Safety Levels** - Implement safety level logic
5. **CLI: Basic Interface** - Minimal CLI with --diff flag
6. **CLI: Output Generation** - Generate selected-tests.json
7. **Demo App: Setup** - Basic React + Cypress structure
8. **Testing: Unit Tests** - Test core logic
9. **Documentation: Examples** - Usage examples

## Configuration Files

- **Root `package.json`**: Workspace definitions, shared scripts
- **`tsconfig.base.json`**: Shared TypeScript strict config
- **Package `package.json`**: Individual package configs
- **Package `tsconfig.json`**: Extends base, package-specific settings

## Output Files

- **`selected-tests.json`**: Generated by CLI, contains selected test paths
- **Console output**: Human-readable format for development

